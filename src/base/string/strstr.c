/******************************************************************************
 *	Copyright (C) 2019	Alejandro Colomar Andr√©s		      *
 *	SPDX-License-Identifier:	LGPL-2.0-only			      *
 ******************************************************************************/


/******************************************************************************
 ******* headers **************************************************************
 ******************************************************************************/
#include "libalx/base/string/strstr.h"

#include <ctype.h>
#include <stddef.h>
#include <string.h>


/******************************************************************************
 ******* macros ***************************************************************
 ******************************************************************************/


/******************************************************************************
 ******* enums ****************************************************************
 ******************************************************************************/


/******************************************************************************
 ******* structs / unions *****************************************************
 ******************************************************************************/


/******************************************************************************
 ******* variables ************************************************************
 ******************************************************************************/


/******************************************************************************
 ******* static functions (prototypes) ****************************************
 ******************************************************************************/


/******************************************************************************
 ******* global functions *****************************************************
 ******************************************************************************/
ptrdiff_t	alx_strncasestr		(ptrdiff_t size,
					const char str[restrict size],
					const char pattern[restrict])
{
	char	str_lower[size];
	char	pat_lower[size];
	char	*p;

	if (!size)
		return	-1;
	if (!pattern[0])
		return	0;

	for (ptrdiff_t i = 0; i < size; i++) {
		str_lower[i]	= tolower((unsigned char)str[i]);
		if (!str_lower[i])
			break;
	}
	for (ptrdiff_t i = 0; i < size; i++) {
		pat_lower[i]	= tolower((unsigned char)pattern[i]);
		if (!pat_lower[i])
			break;
	}

	p	= strnstr(str_lower, pat_lower, size);

	if (!p)
		return	-1;
	return	p - str_lower;
}


/******************************************************************************
 ******* static functions (definitions) ***************************************
 ******************************************************************************/


/******************************************************************************
 ******* end of file **********************************************************
 ******************************************************************************/
